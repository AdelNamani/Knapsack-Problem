<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>TPGO</title>
</head>
<body>
    <div id="root">
        <div>
            Entrer le poids maximale
        </div>
        <div>
            <label>Poids</label>
            <input type="number" v-model="poids_maximum" >
        </div>
        <div>
            <p>Entrer les objets</p>
        </div>
        <div>
            <label>Nom</label>
            <input v-model="nom" placeholder="Nom">
            <label>Poids</label>
            <input v-model="poids" type="number">
            <label>Valeur</label>
            <input v-model="valeur" type="number">
        </div>
        <div>
            <button @click="addObject">Ajouter</button>
        </div>
        <div>
            <ul>
                <li v-for="object in objects" >
                    <p>{{object.nom+' | Son poids:'+object.poids+' | sa valeur:'+object.valeur}} <button @click="deleteObject(object.id)">Supprimer</button></p>
                </li>
            </ul>
        </div>
        <div>
            <button @click="knapsack">Valider</button>
            <p>{{'La valeur maximale est'+this.valeur_maximum}}</p>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script>
        let app = new Vue({
            el : "#root",
            data : {
                poids_maximum : 10,
                last_id : 3,
                nom : "",
                poids : 0,
                valeur : 0,
                objects : [{
                    id : 1,
                    nom : 'Stylo',
                    valeur : 5,
                    poids : 2
                },
                {
                    id : 2,
                    nom : 'Cahier',
                    valeur : 3,
                    poids : 5
                },
                {
                    id : 3,
                    nom : 'Livre',
                    valeur : 4,
                    poids : 8
                }],
                valeur_maximum : 0
            },
            methods:{
                addObject() {
                    newObject = {};
                    newObject.id = this.last_id + 1;
                    newObject.nom = this.nom;
                    newObject.poids = this.poids;
                    newObject.valeur = this.valeur;
                    this.objects.push(newObject);
                    this.nom = "";
                    this.poids = 0;
                    this.valeur = 0;
                    this.last_id++;
                
                }, 

                deleteObject(id){
                    this.objects = this.objects.filter((value)=>{
                        return value.id != id; 
                    });
                },
                
                knapsack(){
                    this.valeur_maximum = this.find_max_value();
                },

                find_max_value(){
                    
                    objects = [{
                        id : 0,
                        nom : '',
                        valeur : 0,
                        poids : 0
                    }];
                    this.objects.map(o=>objects.push(o));
                    console.log(objects);
                    rows = objects.length;
                    columns = parseInt(this.poids_maximum)+1;
                    let matrice = Array(rows).fill().map(() => Array(columns).fill(0));
    
                    for(i=0;i<rows;i++){
                        for(j=0;j<columns;j++){
                            if(i==0 || j==0){
                                matrice[i][j]=0
                            }else if(j<objects[i].poids){
                                matrice[i][j] = matrice[i-1][j]
                            }
                            else {
                                matrice[i][j] = Math.max( matrice[i-1][j] , parseInt(matrice[i-1][j-objects[i].poids]) + parseInt(objects[i].valeur));
                            }

                        }  
                        console.log(i) 
                    }
                    console.log(matrice);
                    return matrice[rows - 1][columns - 1];
                }
            }

        })
    </script>
</body>
</html>